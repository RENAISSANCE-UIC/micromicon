% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/queries.R
\name{blast_protein}
\alias{blast_protein}
\title{Submit Protein BLAST Search}
\usage{
blast_protein(
  sequence,
  database = "swissprot",
  dbdir = "",
  evalue = 1e-10,
  threads = parallel::detectCores(),
  validate_db = TRUE,
  max_hits = 20
)
}
\arguments{
\item{sequence}{Protein sequence as character string or AAString}

\item{database}{Name of BLAST database (e.g., "swissprot", "nr")}

\item{dbdir}{Optional: explicit directory containing databases (overrides BLASTDB)}

\item{evalue}{E-value threshold (default 1e-10)}

\item{threads}{Number of threads to use (default: all available cores)}

\item{validate_db}{Logical; check if database exists before running (default TRUE)}

\item{max_hits}{Maximum number of hits to return (default 20)}
}
\value{
tibble with BLAST hits containing columns:
\itemize{
\item qseqid: query sequence ID
\item sacc: subject accession
\item stitle: subject title/description
\item pident: percent identity
\item length: alignment length
\item qcovs: query coverage per subject
\item bitscore: bit score
\item evalue: expect value
\item staxids: subject taxonomic IDs
}
}
\description{
\strong{IMPORTANT}: This function ONLY supports LOCAL BLAST databases.
Remote BLAST is not supported. You must have:
\enumerate{
\item BLAST+ installed (blastp binary accessible)
\item A local protein database (e.g., SwissProt, nr, RefSeq)
\item BLASTDB environment variable set to the database directory
}
}
\details{
Run Local BLASTP Against Protein Sequence
}
\section{Required External Dependencies}{

\itemize{
\item \strong{BLAST+}: Command-line BLAST tools must be installed
\itemize{
\item Install: https://ftp.ncbi.nlm.nih.gov/blast/executables/blast+/LATEST/
\item Or via conda: \verb{conda install -c bioconda blast}
}
\item \strong{Local Database}: Download from NCBI or build your own
\itemize{
\item SwissProt: ftp://ftp.ncbi.nlm.nih.gov/blast/db/swissprot.tar.gz
\item Extract to a directory and set BLASTDB environment variable
}
}
}

\section{Environment Variables}{

Set \code{BLASTDB} to the directory containing your BLAST databases:

\if{html}{\out{<div class="sourceCode">}}\preformatted{Sys.setenv(BLASTDB = "/path/to/blast/databases")
}\if{html}{\out{</div>}}

Or in your .Renviron file:

\if{html}{\out{<div class="sourceCode">}}\preformatted{BLASTDB=/path/to/blast/databases
}\if{html}{\out{</div>}}
}

\examples{
\dontrun{
# Set BLASTDB environment variable
Sys.setenv(BLASTDB = "/path/to/blast/databases")

# Run BLASTP
results <- blast_protein(
  sequence = "MPNFFIDRPIFAWVIAIIIMLAGGLAILK...",
  database = "swissprot",
  evalue = 1e-5,
  max_hits = 10
)

# View results
print(results)
}
}
